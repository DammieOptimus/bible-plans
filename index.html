<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-M5T96RK7');</script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dammie Optimus NT Reading Plan</title>
    <style>
        /*-------------------*/
        /*  1. Global Styles & Fonts */
        /*-------------------*/
        @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Source+Sans+Pro:wght@400;600&display=swap');

        :root {
            --primary-color: #1a202c;
            --secondary-color: #2d3748;
            --accent-color: #f6ad55;
            --text-color: #edf2f7;
            --text-muted-color: #a0aec0;
            --completed-color: #48bb78;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background-color: var(--primary-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        h1,
        h2,
        h3 {
            font-family: 'Lora', serif;
            font-weight: 700;
        }

        /*-------------------*/
        /*  2. Header & Plan Selector */
        /*-------------------*/
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        .header p {
            font-size: 1.1rem;
            color: var(--text-muted-color);
        }

        .plan-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 2.5rem;
            background-color: var(--secondary-color);
            border-radius: 12px;
            padding: 0.5rem;
        }

        .plan-button {
            background: none;
            border: none;
            color: var(--text-muted-color);
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 200px;
        }

        .plan-button.active {
            background-color: var(--accent-color);
            color: var(--primary-color);
            box-shadow: 0 4px 14px rgba(246, 173, 85, 0.2);
        }

        .plan-button:not(.active):hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /*-------------------*/
        /*  3. Reading Plan Grid & Cards */
        /*-------------------*/
        .reading-plan {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .day-card {
            background-color: var(--secondary-color);
            border-radius: 12px;
            border-left: 5px solid transparent;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-header h3 {
            font-size: 1.5rem;
            color: var(--accent-color);
        }

        .completion-checkbox {
            /* Hiding the default checkbox */
            opacity: 0;
            position: absolute;
            width: 0;
            height: 0;
        }

        .completion-label {
            position: relative;
            cursor: pointer;
            width: 24px;
            height: 24px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.3s ease;
        }

        .completion-label::after {
            content: '';
            position: absolute;
            left: 8px;
            top: 4px;
            width: 5px;
            height: 10px;
            border: solid var(--text-color);
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .completion-checkbox:checked+.completion-label {
            background-color: var(--completed-color);
        }

        .completion-checkbox:checked+.completion-label::after {
            opacity: 1;
        }

        .card-content .scripture {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem; /* Adjusted for better spacing with buttons */
        }

        .card-content .chapters,
        .card-content .notes {
            color: var(--text-muted-color);
        }

        .card-content .notes {
            margin-top: 0.75rem;
            font-style: italic;
            font-size: 0.9rem;
            border-left: 2px solid var(--accent-color);
            padding-left: 0.75rem;
        }

        /* Completed State Styling */
        .day-card.completed {
            border-left-color: var(--completed-color);
            background-color: #354763;
        }

        .day-card.completed .card-content {
            opacity: 0.6;
        }

        /*-------------------*/
        /*  4. Hide/Show Plans */
        /*-------------------*/
        #canonical-plan {
            display: none;
        }

        /*-------------------*/
        /*  5. Footer */
        /*-------------------*/
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--secondary-color);
            color: var(--text-muted-color);
            font-size: 0.9rem;
        }

        /* 6. App Switcher */
        .app-switcher {
            text-align: center;
            margin: -1rem auto 2.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .switcher-link {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 1.25rem;
            border-radius: 50px;
            /* Pill shape */
            background-color: var(--secondary-color);
            color: var(--text-muted-color);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .switcher-link:hover {
            color: var(--accent-color);
            background-color: rgba(246, 173, 85, 0.1);
            border-color: rgba(246, 173, 85, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .switcher-link svg {
            transition: transform 0.3s ease;
        }

        .switcher-link:hover svg {
            transform: translateX(4px);
        }

        /* 7. Card Actions & Copy Button */
        .card-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .copy-button {
            background: none;
            border: none;
            color: var(--text-muted-color);
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease-in-out;
        }
        
        .copy-button:hover {
            color: var(--accent-color);
            background-color: rgba(246, 173, 85, 0.1);
        }
        
        .copy-button .check-icon {
            display: none;
        }
        
        .copy-button.copied {
            color: var(--completed-color);
        }
        
        .copy-button.copied .copy-icon {
            display: none;
        }
        
        .copy-button.copied .check-icon {
            display: block;
        }

        /* 8. Copyright Footer */
        .footer .copyright {
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-muted-color);
        }
        
        @keyframes color-cycle-nt {
            0%   { color: var(--accent-color); text-shadow: 0 0 5px rgba(246, 173, 85, 0.5); }
            25%  { color: #63b3ed; text-shadow: 0 0 5px rgba(99, 179, 237, 0.5); }
            50%  { color: var(--completed-color); text-shadow: 0 0 5px rgba(72, 187, 120, 0.5); }
            75%  { color: #a0aec0; text-shadow: 0 0 5px rgba(160, 174, 192, 0.5); }
            100% { color: var(--accent-color); text-shadow: 0 0 5px rgba(246, 173, 85, 0.5); }
        }
        
        @keyframes pulse {
            0%   { transform: scale(1); }
            50%  { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulsating-link {
            font-weight: 600;
            text-decoration: none;
            animation: color-cycle-nt 8s infinite linear, pulse 3s infinite ease-in-out;
            transition: transform 0.2s ease;
            display: inline-block; /* Needed for transform */
        }
        
        .pulsating-link:hover {
            animation-play-state: paused; /* Pause animation on hover for better UX */
            transform: scale(1.1);
        }

        /* 9. Reset Button */
        .reset-container {
            margin: 2rem 0;
            text-align: center;
        }
        
        .reset-button {
            background-color: transparent;
            border: 2px solid var(--text-muted-color);
            color: var(--text-muted-color);
            padding: 0.6rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .reset-button:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(246, 173, 85, 0.2);
        }

        /* 10. Version Selector & Chapter Buttons */
        .version-selector-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2.5rem;
            padding: 0.5rem;
            background-color: var(--secondary-color);
            border-radius: 8px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        #version-selector {
            width: 100%;
            background-color: var(--primary-color);
            color: var(--text-color);
            border: 1px solid var(--text-muted-color);
            border-radius: 6px;
            padding: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
        }
        
        .card-content .scripture-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .chapter-button {
            background-color: var(--primary-color);
            color: var(--text-color); /* Default text color */
            border: 1px solid var(--secondary-color);
            border-radius: 6px;
            padding: 0.3rem 0.7rem;
            font-size: 0.9rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.2s ease;
            position: relative; /* Needed for tooltip */
        }
        
        /* Color Coding for Chapter Length */
        .chapter-short { background-color: #2c523a; border-color: #38a169; }
        .chapter-medium { background-color: #2c5282; border-color: #4299e1; } /* Blue for Medium */
        .chapter-long { background-color: #7b341e; border-color: #dd6b20; }
        .chapter-epic { background-color: #7a2a2a; border-color: #c53030; }
        
        .chapter-button:hover {
            color: var(--primary-color); /* Text color on hover for all buttons */
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        
        /* Hover background colors */
        .chapter-short:hover { background-color: #38a169; border-color: #68d391; }
        .chapter-medium:hover { background-color: #4299e1; border-color: #63b3ed; }
        .chapter-long:hover { background-color: #dd6b20; border-color: #f6ad55; }
        .chapter-epic:hover { background-color: #c53030; border-color: #f56565; }
        
        /* Tooltip for Verse Count - works on hover (desktop) and can be triggered by JS (mobile) */
        .chapter-button::before {
            content: attr(data-verses);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: var(--text-color);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.85rem;
            white-space: nowrap;
            z-index: 10;
            
            /* Initially hidden */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }
        
        .chapter-button:hover::before {
            opacity: 1;
            visibility: visible;
        }
        
        .scripture-placeholder {
            font-style: italic;
            color: var(--text-muted-color);
        }
    </style>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M5T96RK7"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="container">
        <header class="header">
            <h1>Dammie Optimus</h1>
            <p>New Testament in a Month Reading Plan</p>
        </header>

        <!-- App Switcher -->
        <div class="app-switcher">
            <a href="./old_testament_in_four_months.html" class="switcher-link">OT in 4 Months Plan</a>
            <a href="./complete_bible_in_a_year.html" class="switcher-link">Complete Bible Plan</a>
        </div>

        <div class="version-selector-container">
            <label for="version-selector">Bible Version:</label>
            <select id="version-selector" name="version-selector"></select>
        </div>
        
        <div class="plan-selector">
            <button class="plan-button" data-plan="canonical">Canonical Order</button>
            <button class="plan-button active" data-plan="chronological">Chronological Order</button>
        </div>

        <!-- Canonical Plan -->
        <section id="canonical-plan" class="reading-plan"></section>

        <!-- Chronological Plan -->
        <section id="chronological-plan" class="reading-plan"></section>

        <footer class="footer">
            <p>"Your word is a lamp for my feet, a light on my path." - Psalm 119:105</p>
            
            <div class="reset-container">
                <button id="reset-progress-button" class="reset-button">Reset All Progress</button>
            </div>
        
            <p class="copyright">&copy; <span id="copyright-year"></span> <a href="https://dammieoptimus.github.io/tgrstartnow/?d=eyJyZWYiOiJEYW1taWVPcHRpbXVzMiIsIm5hbWUiOiJEYW1taWUgKE9wdGltdXMpIEF5b2RlbGUiLCJwaG9uZSI6IjA4MDI4OTc1ODE2IiwicGljIjoiaHR0cHM6Ly9pLmltZ3VyLmNvbS9xcVVFNGFyLmpwZyJ9" class="pulsating-link" target="_blank" rel="noopener noreferrer">Dammie Optimus Solutions</a>. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            document.getElementById('copyright-year').textContent = new Date().getFullYear();

            //-------------------*/
            //  Scroll Position Memory
            //-------------------*/
            const SCROLL_MEMORY_KEY_NT = 'dammieOptimus_lastViewedId_NT';
            
            // Throttling function to limit how often a function can run.
            function throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }
            
            // Function to find the topmost visible day-card and save its ID.
            function saveLastViewedPosition() {
                let lastVisibleCardId = null;
                const activePlanElement = document.querySelector('.reading-plan:not([style*="display: none"])');
                if (!activePlanElement) return;
            
                const visibleCards = activePlanElement.querySelectorAll('.day-card');
                
                // Find the first card that is in the top half of the viewport
                for (const card of visibleCards) {
                    const rect = card.getBoundingClientRect();
                    if (rect.top >= 0 && rect.top <= window.innerHeight / 2) {
                        lastVisibleCardId = card.id;
                        break; 
                    }
                }
            
                if (lastVisibleCardId) {
                    localStorage.setItem(SCROLL_MEMORY_KEY_NT, lastVisibleCardId);
                }
            }
            
            // Function to scroll to the saved position on page load.
            function scrollToLastViewedPosition() {
                const lastViewedId = localStorage.getItem(SCROLL_MEMORY_KEY_NT);
                if (lastViewedId) {
                    const element = document.getElementById(lastViewedId);
            
                    // This is a key step: ensure the correct tab is active before scrolling
                    if (element) {
                        const planName = lastViewedId.startsWith('canonical') ? 'canonical' : 'chronological';
                        const planButton = document.querySelector(`.plan-button[data-plan="${planName}"]`);
                        if (planButton && !planButton.classList.contains('active')) {
                            planButton.click();
                        }
            
                        // Use a small timeout to ensure the layout is stable after the tab switch
                        setTimeout(() => {
                            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 100);
                    }
                }
            }
            
            // Attach the scroll listener
            window.addEventListener('scroll', throttle(saveLastViewedPosition, 500));
            // Call the scroll restoration function
            //scrollToLastViewedPosition();

            //================================================
            // BIBLE LINKING & VERSION MANAGEMENT LIBRARY
            //================================================
            
            // --- 1. Bible Version Data (Easily extendable) ---
            const bibleVersions = [
                { name: "EasyEnglish Bible 2024", number: 2079, abbr: "EASY" },
                { name: "Amplified Bible (AMP)", number: 1588, abbr: "AMP" },
                { name: "New King James Version (NKJV)", number: 114, abbr: "NKJV" },
                { name: "New International Version (NIV)", number: 111, abbr: "NIV" },
                { name: "English Standard Version (ESV)", number: 59, abbr: "ESV" },
                { name: "King James Version (KJV)", number: 1, abbr: "KJV" },
                { name: "New Living Translation (NLT)", number: 116, abbr: "NLT" },
                { name: "Christian Standard Bible (CSB)", number: 1713, abbr: "CSB" },
                { name: "The Message (MSG)", number: 97, abbr: "MSG" },
                { name: "King James Version with Apocrypha, American Edition (KJVAAE)", number: 546, abbr: "KJVAAE" },
                { name: "Bible in Yorùbá (YCB)", number: 911, abbr: "YCB" },
                { name: "Bible in Hausa (SRK)", number: 1614, abbr: "SRK" },
                { name: "Bible in Igbo (BIU)", number: 1624, abbr: "BIU" },
                { name: "Bible in French (BEX2004)", number: 3286, abbr: "BEX2004" }
            ];

            const bibleVerseData = {
                "Genesis": { "1": 31, "2": 25, "3": 24, "4": 26, "5": 32, "6": 22, "7": 24, "8": 22, "9": 29, "10": 32, "11": 32, "12": 20, "13": 18, "14": 24, "15": 21, "16": 16, "17": 27, "18": 33, "19": 38, "20": 18, "21": 34, "22": 24, "23": 20, "24": 67, "25": 34, "26": 35, "27": 46, "28": 22, "29": 35, "30": 43, "31": 55, "32": 32, "33": 20, "34": 31, "35": 29, "36": 43, "37": 36, "38": 30, "39": 23, "40": 23, "41": 57, "42": 38, "43": 34, "44": 34, "45": 28, "46": 34, "47": 31, "48": 22, "49": 33, "50": 26 },
                "Exodus": { "1": 22, "2": 25, "3": 22, "4": 31, "5": 23, "6": 30, "7": 25, "8": 32, "9": 35, "10": 29, "11": 10, "12": 51, "13": 22, "14": 31, "15": 27, "16": 36, "17": 16, "18": 27, "19": 25, "20": 26, "21": 36, "22": 31, "23": 33, "24": 18, "25": 40, "26": 37, "27": 21, "28": 43, "29": 46, "30": 38, "31": 18, "32": 35, "33": 23, "34": 35, "35": 35, "36": 38, "37": 29, "38": 31, "39": 43, "40": 38 },
                "Leviticus": { "1": 17, "2": 16, "3": 17, "4": 35, "5": 19, "6": 30, "7": 38, "8": 36, "9": 24, "10": 20, "11": 47, "12": 8, "13": 59, "14": 57, "15": 33, "16": 34, "17": 16, "18": 30, "19": 37, "20": 27, "21": 24, "22": 33, "23": 44, "24": 23, "25": 55, "26": 46, "27": 34 },
                "Numbers": { "1": 54, "2": 34, "3": 51, "4": 49, "5": 31, "6": 27, "7": 89, "8": 26, "9": 23, "10": 36, "11": 35, "12": 16, "13": 33, "14": 45, "15": 41, "16": 50, "17": 13, "18": 32, "19": 22, "20": 29, "21": 35, "22": 41, "23": 30, "24": 25, "25": 18, "26": 65, "27": 23, "28": 31, "29": 40, "30": 16, "31": 54, "32": 42, "33": 56, "34": 29, "35": 34, "36": 13 },
                "Deuteronomy": { "1": 46, "2": 37, "3": 29, "4": 49, "5": 33, "6": 25, "7": 26, "8": 20, "9": 29, "10": 22, "11": 32, "12": 32, "13": 18, "14": 29, "15": 23, "16": 22, "17": 20, "18": 22, "19": 21, "20": 20, "21": 23, "22": 30, "23": 25, "24": 22, "25": 19, "26": 19, "27": 26, "28": 68, "29": 29, "30": 20, "31": 30, "32": 52, "33": 29, "34": 12 },
                "Joshua": { "1": 18, "2": 24, "3": 17, "4": 24, "5": 15, "6": 27, "7": 26, "8": 35, "9": 27, "10": 43, "11": 23, "12": 24, "13": 33, "14": 15, "15": 63, "16": 10, "17": 18, "18": 28, "19": 51, "20": 9, "21": 45, "22": 34, "23": 16, "24": 33 },
                "Judges": { "1": 36, "2": 23, "3": 31, "4": 24, "5": 31, "6": 40, "7": 25, "8": 35, "9": 57, "10": 18, "11": 40, "12": 15, "13": 25, "14": 20, "15": 20, "16": 31, "17": 13, "18": 31, "19": 30, "20": 48, "21": 25 },
                "Ruth": { "1": 22, "2": 23, "3": 18, "4": 22 },
                "1 Samuel": { "1": 28, "2": 36, "3": 21, "4": 22, "5": 12, "6": 21, "7": 17, "8": 22, "9": 27, "10": 27, "11": 15, "12": 25, "13": 23, "14": 52, "15": 35, "16": 23, "17": 58, "18": 30, "19": 24, "20": 42, "21": 15, "22": 23, "23": 29, "24": 22, "25": 44, "26": 25, "27": 12, "28": 25, "29": 11, "30": 31, "31": 13 },
                "2 Samuel": { "1": 27, "2": 32, "3": 39, "4": 12, "5": 25, "6": 23, "7": 29, "8": 18, "9": 13, "10": 19, "11": 27, "12": 31, "13": 39, "14": 33, "15": 37, "16": 23, "17": 29, "18": 33, "19": 43, "20": 26, "21": 22, "22": 51, "23": 39, "24": 25 },
                "1 Kings": { "1": 53, "2": 46, "3": 28, "4": 34, "5": 18, "6": 38, "7": 51, "8": 66, "9": 28, "10": 29, "11": 43, "12": 33, "13": 34, "14": 31, "15": 34, "16": 34, "17": 24, "18": 46, "19": 21, "20": 43, "21": 29, "22": 53 },
                "2 Kings": { "1": 18, "2": 25, "3": 27, "4": 44, "5": 27, "6": 33, "7": 20, "8": 29, "9": 37, "10": 36, "11": 21, "12": 21, "13": 25, "14": 29, "15": 38, "16": 20, "17": 41, "18": 37, "19": 37, "20": 21, "21": 26, "22": 20, "23": 37, "24": 20, "25": 30 },
                "1 Chronicles": { "1": 54, "2": 55, "3": 24, "4": 43, "5": 26, "6": 81, "7": 40, "8": 40, "9": 44, "10": 14, "11": 47, "12": 40, "13": 14, "14": 17, "15": 29, "16": 43, "17": 27, "18": 17, "19": 19, "20": 8, "21": 30, "22": 19, "23": 32, "24": 31, "25": 31, "26": 32, "27": 34, "28": 21, "29": 30 },
                "2 Chronicles": { "1": 17, "2": 18, "3": 17, "4": 22, "5": 14, "6": 42, "7": 22, "8": 18, "9": 31, "10": 19, "11": 23, "12": 16, "13": 22, "14": 15, "15": 19, "16": 14, "17": 19, "18": 34, "19": 11, "20": 37, "21": 20, "22": 12, "23": 21, "24": 27, "25": 28, "26": 23, "27": 9, "28": 27, "29": 36, "30": 27, "31": 21, "32": 33, "33": 25, "34": 33, "35": 27, "36": 23 },
                "Ezra": { "1": 11, "2": 70, "3": 13, "4": 24, "5": 17, "6": 22, "7": 28, "8": 36, "9": 15, "10": 44 },
                "Nehemiah": { "1": 11, "2": 20, "3": 32, "4": 23, "5": 19, "6": 19, "7": 73, "8": 18, "9": 38, "10": 39, "11": 36, "12": 47, "13": 31 },
                "Esther": { "1": 22, "2": 23, "3": 15, "4": 17, "5": 14, "6": 14, "7": 10, "8": 17, "9": 32, "10": 3 },
                "Job": { "1": 22, "2": 13, "3": 26, "4": 21, "5": 27, "6": 30, "7": 21, "8": 22, "9": 35, "10": 22, "11": 20, "12": 25, "13": 28, "14": 22, "15": 35, "16": 22, "17": 16, "18": 21, "19": 29, "20": 29, "21": 34, "22": 30, "23": 17, "24": 25, "25": 6, "26": 14, "27": 23, "28": 28, "29": 25, "30": 31, "31": 40, "32": 22, "33": 33, "34": 37, "35": 16, "36": 33, "37": 24, "38": 41, "39": 30, "40": 24, "41": 34, "42": 17 },
                "Psalm": { "1": 6, "2": 12, "3": 8, "4": 8, "5": 12, "6": 10, "7": 17, "8": 9, "9": 20, "10": 18, "11": 7, "12": 8, "13": 6, "14": 7, "15": 5, "16": 11, "17": 15, "18": 50, "19": 14, "20": 9, "21": 13, "22": 31, "23": 6, "24": 10, "25": 22, "26": 12, "27": 14, "28": 9, "29": 11, "30": 12, "31": 24, "32": 11, "33": 22, "34": 22, "35": 28, "36": 12, "37": 40, "38": 22, "39": 13, "40": 17, "41": 13, "42": 11, "43": 5, "44": 26, "45": 17, "46": 11, "47": 9, "48": 14, "49": 20, "50": 23, "51": 19, "52": 9, "53": 6, "54": 7, "55": 23, "56": 13, "57": 11, "58": 11, "59": 17, "60": 12, "61": 8, "62": 12, "63": 11, "64": 10, "65": 13, "66": 20, "67": 7, "68": 35, "69": 36, "70": 5, "71": 24, "72": 20, "73": 28, "74": 23, "75": 10, "76": 12, "77": 20, "78": 72, "79": 13, "80": 19, "81": 16, "82": 8, "83": 18, "84": 12, "85": 13, "86": 17, "87": 7, "88": 18, "89": 52, "90": 17, "91": 16, "92": 15, "93": 5, "94": 23, "95": 11, "96": 13, "97": 12, "98": 9, "99": 9, "100": 5, "101": 8, "102": 28, "103": 22, "104": 35, "105": 45, "106": 48, "107": 43, "108": 13, "109": 31, "110": 7, "111": 10, "112": 10, "113": 9, "114": 8, "115": 18, "116": 19, "117": 2, "118": 29, "119": 176, "120": 7, "121": 8, "122": 9, "123": 4, "124": 8, "125": 5, "126": 6, "127": 5, "128": 6, "129": 8, "130": 8, "131": 3, "132": 18, "133": 3, "134": 3, "135": 21, "136": 26, "137": 9, "138": 8, "139": 24, "140": 13, "141": 10, "142": 7, "143": 12, "144": 15, "145": 21, "146": 10, "147": 20, "148": 14, "149": 9, "150": 6 },
                "Proverbs": { "1": 33, "2": 22, "3": 35, "4": 27, "5": 23, "6": 35, "7": 27, "8": 36, "9": 18, "10": 32, "11": 31, "12": 28, "13": 25, "14": 35, "15": 33, "16": 33, "17": 28, "18": 24, "19": 29, "20": 30, "21": 31, "22": 29, "23": 35, "24": 34, "25": 28, "26": 28, "27": 27, "28": 28, "29": 27, "30": 33, "31": 31 },
                "Ecclesiastes": { "1": 18, "2": 26, "3": 22, "4": 16, "5": 20, "6": 12, "7": 29, "8": 17, "9": 18, "10": 20, "11": 10, "12": 14 },
                "Song of Solomon": { "1": 17, "2": 17, "3": 11, "4": 16, "5": 16, "6": 13, "7": 13, "8": 14 },
                "Isaiah": { "1": 31, "2": 22, "3": 26, "4": 6, "5": 30, "6": 13, "7": 25, "8": 22, "9": 21, "10": 34, "11": 16, "12": 6, "13": 22, "14": 32, "15": 9, "16": 14, "17": 14, "18": 7, "19": 25, "20": 6, "21": 17, "22": 25, "23": 18, "24": 23, "25": 12, "26": 21, "27": 13, "28": 29, "29": 24, "30": 33, "31": 9, "32": 20, "33": 24, "34": 17, "35": 10, "36": 22, "37": 38, "38": 22, "39": 8, "40": 31, "41": 29, "42": 25, "43": 28, "44": 28, "45": 25, "46": 13, "47": 15, "48": 22, "49": 26, "50": 11, "51": 23, "52": 15, "53": 12, "54": 17, "55": 13, "56": 12, "57": 21, "58": 14, "59": 21, "60": 22, "61": 11, "62": 12, "63": 19, "64": 12, "65": 25, "66": 24 },
                "Jeremiah": { "1": 19, "2": 37, "3": 25, "4": 31, "5": 31, "6": 30, "7": 34, "8": 22, "9": 26, "10": 25, "11": 23, "12": 17, "13": 27, "14": 22, "15": 21, "16": 21, "17": 27, "18": 23, "19": 15, "20": 18, "21": 14, "22": 30, "23": 40, "24": 10, "25": 38, "26": 24, "27": 22, "28": 17, "29": 32, "30": 24, "31": 40, "32": 44, "33": 26, "34": 22, "35": 19, "36": 32, "37": 21, "38": 28, "39": 18, "40": 16, "41": 18, "42": 22, "43": 13, "44": 30, "45": 5, "46": 28, "47": 7, "48": 47, "49": 39, "50": 46, "51": 64, "52": 34 },
                "Lamentations": { "1": 22, "2": 22, "3": 66, "4": 22, "5": 22 },
                "Ezekiel": { "1": 28, "2": 10, "3": 27, "4": 17, "5": 17, "6": 14, "7": 27, "8": 18, "9": 11, "10": 22, "11": 25, "12": 28, "13": 23, "14": 23, "15": 8, "16": 63, "17": 24, "18": 32, "19": 14, "20": 49, "21": 32, "22": 31, "23": 49, "24": 27, "25": 17, "26": 21, "27": 36, "28": 26, "29": 21, "30": 26, "31": 18, "32": 32, "33": 33, "34": 31, "35": 15, "36": 38, "37": 28, "38": 23, "39": 29, "40": 49, "41": 26, "42": 20, "43": 27, "44": 31, "45": 25, "46": 24, "47": 23, "48": 35 },
                "Daniel": { "1": 21, "2": 49, "3": 30, "4": 37, "5": 31, "6": 28, "7": 28, "8": 27, "9": 27, "10": 21, "11": 45, "12": 13 },
                "Hosea": { "1": 11, "2": 23, "3": 5, "4": 19, "5": 15, "6": 11, "7": 16, "8": 14, "9": 17, "10": 15, "11": 12, "12": 14, "13": 16, "14": 9 },
                "Joel": { "1": 20, "2": 32, "3": 21 }, "Amos": { "1": 15, "2": 16, "3": 15, "4": 13, "5": 27, "6": 14, "7": 17, "8": 14, "9": 15 },
                "Obadiah": { "1": 21 }, "Jonah": { "1": 17, "2": 10, "3": 10, "4": 11 }, "Micah": { "1": 16, "2": 13, "3": 12, "4": 13, "5": 15, "6": 16, "7": 20 },
                "Nahum": { "1": 15, "2": 13, "3": 19 }, "Habakkuk": { "1": 17, "2": 20, "3": 19 }, "Zephaniah": { "1": 18, "2": 15, "3": 20 },
                "Haggai": { "1": 15, "2": 23 }, "Zechariah": { "1": 21, "2": 13, "3": 10, "4": 14, "5": 11, "6": 15, "7": 14, "8": 23, "9": 17, "10": 12, "11": 17, "12": 14, "13": 9, "14": 21 },
                "Malachi": { "1": 14, "2": 17, "3": 18, "4": 6 },
                "Matthew": { "1": 25, "2": 23, "3": 17, "4": 25, "5": 48, "6": 34, "7": 29, "8": 34, "9": 38, "10": 42, "11": 30, "12": 50, "13": 58, "14": 36, "15": 39, "16": 28, "17": 27, "18": 35, "19": 30, "20": 34, "21": 46, "22": 46, "23": 39, "24": 51, "25": 46, "26": 75, "27": 66, "28": 20 },
                "Mark": { "1": 45, "2": 28, "3": 35, "4": 41, "5": 43, "6": 56, "7": 37, "8": 38, "9": 50, "10": 52, "11": 33, "12": 44, "13": 37, "14": 72, "15": 47, "16": 20 },
                "Luke": { "1": 80, "2": 52, "3": 38, "4": 44, "5": 39, "6": 49, "7": 50, "8": 56, "9": 62, "10": 42, "11": 54, "12": 59, "13": 35, "14": 35, "15": 32, "16": 31, "17": 37, "18": 43, "19": 48, "20": 47, "21": 38, "22": 71, "23": 56, "24": 53 },
                "John": { "1": 51, "2": 25, "3": 36, "4": 54, "5": 47, "6": 71, "7": 53, "8": 59, "9": 41, "10": 42, "11": 57, "12": 50, "13": 38, "14": 31, "15": 27, "16": 33, "17": 26, "18": 40, "19": 42, "20": 31, "21": 25 },
                "Acts": { "1": 26, "2": 47, "3": 26, "4": 37, "5": 42, "6": 15, "7": 60, "8": 40, "9": 43, "10": 48, "11": 30, "12": 25, "13": 52, "14": 28, "15": 41, "16": 40, "17": 34, "18": 28, "19": 41, "20": 38, "21": 40, "22": 30, "23": 35, "24": 27, "25": 27, "26": 32, "27": 44, "28": 31 },
                "Romans": { "1": 32, "2": 29, "3": 31, "4": 25, "5": 21, "6": 23, "7": 25, "8": 39, "9": 33, "10": 21, "11": 36, "12": 21, "13": 14, "14": 23, "15": 33, "16": 27 },
                "1 Corinthians": { "1": 31, "2": 16, "3": 23, "4": 21, "5": 13, "6": 20, "7": 40, "8": 13, "9": 27, "10": 33, "11": 34, "12": 31, "13": 13, "14": 40, "15": 58, "16": 24 },
                "2 Corinthians": { "1": 24, "2": 17, "3": 18, "4": 18, "5": 21, "6": 18, "7": 16, "8": 24, "9": 15, "10": 18, "11": 33, "12": 21, "13": 14 },
                "Galatians": { "1": 24, "2": 21, "3": 29, "4": 31, "5": 26, "6": 18 },
                "Ephesians": { "1": 23, "2": 22, "3": 21, "4": 32, "5": 33, "6": 24 },
                "Philippians": { "1": 30, "2": 30, "3": 21, "4": 23 },
                "Colossians": { "1": 29, "2": 23, "3": 25, "4": 18 },
                "1 Thessalonians": { "1": 10, "2": 20, "3": 13, "4": 18, "5": 28 },
                "2 Thessalonians": { "1": 12, "2": 17, "3": 18 },
                "1 Timothy": { "1": 20, "2": 15, "3": 16, "4": 16, "5": 25, "6": 21 },
                "2 Timothy": { "1": 18, "2": 26, "3": 17, "4": 22 },
                "Titus": { "1": 16, "2": 15, "3": 15 }, "Philemon": { "1": 25 },
                "Hebrews": { "1": 14, "2": 18, "3": 19, "4": 16, "5": 14, "6": 20, "7": 28, "8": 13, "9": 28, "10": 39, "11": 40, "12": 29, "13": 25 },
                "James": { "1": 27, "2": 26, "3": 18, "4": 17, "5": 20 },
                "1 Peter": { "1": 25, "2": 25, "3": 22, "4": 19, "5": 14 }, "2 Peter": { "1": 21, "2": 22, "3": 18 },
                "1 John": { "1": 10, "2": 29, "3": 24, "4": 21, "5": 21 }, "2 John": { "1": 13 }, "3 John": { "1": 14 }, "Jude": { "1": 25 },
                "Revelation": { "1": 20, "2": 29, "3": 22, "4": 11, "5": 14, "6": 17, "7": 17, "8": 13, "9": 21, "10": 11, "11": 19, "12": 18, "13": 18, "14": 20, "15": 8, "16": 21, "17": 18, "18": 24, "19": 21, "20": 15, "21": 27, "22": 21 }
            };
            
            // --- 2. Book Abbreviation Map ---
            const bookAbbreviations = {
                // Old Testament
                'Gen': 'GEN', 'Genesis': 'GEN', 'Ex': 'EXO', 'Exodus': 'EXO', 'Lev': 'LEV', 'Leviticus': 'LEV',
                'Num': 'NUM', 'Numbers': 'NUM', 'Deut': 'DEU', 'Deuteronomy': 'DEU', 'Josh': 'JOS', 'Joshua': 'JOS',
                'Judges': 'JDG', 'Ruth': 'RUT', '1 Sam': '1SA', '1 Samuel': '1SA', '2 Sam': '2SA', '2 Samuel': '2SA',
                '1 Kings': '1KI', '2 Kings': '2KI', '1 Chron': '1CH', '1 Chronicles': '1CH', '2 Chron': '2CH', '2 Chronicles': '2CH',
                'Ezra': 'EZR', 'Neh': 'NEH', 'Nehemiah': 'NEH', 'Esther': 'EST', 'Job': 'JOB', 'Ps': 'PSA', 'Psalm': 'PSA', 'Psalms': 'PSA',
                'Prov': 'PRO', 'Proverbs': 'PRO', 'Ecc': 'ECC', 'Ecclesiastes': 'ECC', 'Song of Solomon': 'SNG',
                'Isaiah': 'ISA', 'Isa': 'ISA', 'Jer': 'JER', 'Jeremiah': 'JER', 'Lam': 'LAM', 'Lamentations': 'LAM', 'Ezek': 'EZK', 'Ezekiel': 'EZK',
                'Dan': 'DAN', 'Daniel': 'DAN', 'Hosea': 'HOS', 'Joel': 'JOL', 'Amos': 'AMO', 'Obadiah': 'OBA', 'Jonah': 'JON',
                'Micah': 'MIC', 'Nahum': 'NAM', 'Habakkuk': 'HAB', 'Zeph': 'ZEP', 'Haggai': 'HAG', 'Zech': 'ZEC', 'Zechariah': 'ZEC', 'Malachi': 'MAL',
                // New Testament
                'Matthew': 'MAT', 'Matt': 'MAT', 'Mark': 'MRK', 'Luke': 'LUK', 'John': 'JHN', 'Acts': 'ACT', 'Romans': 'ROM',
                '1 Corinthians': '1CO', '2 Corinthians': '2CO', 'Galatians': 'GAL', 'Ephesians': 'EPH', 'Philippians': 'PHP',
                'Colossians': 'COL', '1 Thessalonians': '1TH', '2 Thessalonians': '2TH', '1 Timothy': '1TI', '2 Timothy': '2TI',
                'Titus': 'TIT', 'Philemon': 'PHM', 'Hebrews': 'HEB', 'James': 'JAS', '1 Peter': '1PE', '2 Peter': '2PE',
                '1 John': '1JN', '2 John': '2JN', '3 John': '3JN', 'Jude': 'JUD', 'Revelation': 'REV'
            };
            
            /**
             * Parses a reading string (e.g., "Mark 1-8 & Matthew 28") and generates clickable buttons.
             * @param {string} readingsString - The string to parse.
             * @returns {string} HTML string of buttons.
             */
            function parseReadingsAndCreateButtons(readingsString) {
                if (!readingsString || readingsString.toLowerCase().includes('catch-up')) {
                    return `<p class="scripture-placeholder">A day for rest and reflection.</p>`;
                }
            
                const versionNumber = localStorage.getItem('dammieOptimus_bibleVersionNumber') || bibleVersions[0].number;
                const selectedVersion = bibleVersions.find(v => v.number == versionNumber) || bibleVersions[0];
                
                let buttonsHtml = '';
                const parts = readingsString.split(/&|;/);
            
                function getChapterLengthClass(verseCount) {
                    if (verseCount >= 55) return 'chapter-epic';
                    if (verseCount >= 40) return 'chapter-long';
                    if (verseCount >= 25) return 'chapter-medium';
                    if (verseCount > 0) return 'chapter-short';
                    return '';
                }
            
                parts.forEach(part => {
                    const trimmedPart = part.trim();
                    const match = trimmedPart.match(/^(.+?)\s+(\d+)(?:-(\d+))?$/);
            
                    if (match) {
                        const parsedBookName = match[1].trim(); // This is the name from the reading plan (e.g., "Gen")
                        const startChapter = parseInt(match[2], 10);
                        const endChapter = match[3] ? parseInt(match[3], 10) : startChapter;
                        
                        // --- THIS SECTION CONTAINS THE FIX ---
                        // 1. Find the alias key in bookAbbreviations (works as before)
                        const aliasKey = Object.keys(bookAbbreviations).find(key => parsedBookName.startsWith(key));
                        
                        // 2. Find the CANONICAL key in bibleVerseData (LOGIC IS NOW REVERSED)
                        // It now correctly checks if the full book name ("Genesis") starts with the parsed name ("Gen").
                        const canonicalKey = Object.keys(bibleVerseData).find(key => key.startsWith(parsedBookName));
                        // --- END OF FIX ---
            
                        if (aliasKey && canonicalKey) {
                            const urlAbbr = bookAbbreviations[aliasKey]; // Get URL ("GEN")
                            
                            for (let i = startChapter; i <= endChapter; i++) {
                                // 3. Use the CANONICAL key for the verse count lookup.
                                const verseCount = bibleVerseData[canonicalKey]?.[i] || 0;
                                
                                const lengthClass = getChapterLengthClass(verseCount);
                                const verseTooltip = verseCount > 0 ? `${verseCount} verses` : 'Info not available';
                                
                                const url = `https://www.bible.com/bible/${selectedVersion.number}/${urlAbbr}.${i}.${selectedVersion.abbr}`;
                                // Display the original parsed name for consistency with the reading string.
                                buttonsHtml += `<a href="${url}" class="chapter-button ${lengthClass}" data-verses="${verseTooltip}" target="_blank" rel="noopener noreferrer">${parsedBookName.replace("Song of Solomon", "SOS")} ${i}</a>`;
                            }
                        }
                    }
                });
            
                return buttonsHtml || `<p class="scripture-placeholder">No readings for this day.</p>`;
            }
            
            /**
             * Populates the version selector dropdown.
             */
            function populateVersionSelector() {
                const selector = document.getElementById('version-selector');
                bibleVersions.forEach(version => {
                    const option = document.createElement('option');
                    option.value = version.number;
                    option.textContent = version.name;
                    selector.appendChild(option);
                });
            }
            
            /**
             * Saves the user's version choice to localStorage and reloads.
             */
            function handleVersionChange(e) {
                localStorage.setItem('dammieOptimus_bibleVersionNumber', e.target.value);
                // Reload the page to apply the new version to all generated links
                location.reload();
            }
            
            /**
             * Loads the saved version from localStorage or sets a default.
             */
            function loadVersionPreference() {
                const savedVersion = localStorage.getItem('dammieOptimus_bibleVersionNumber');
                const selector = document.getElementById('version-selector');
                if (savedVersion) {
                    selector.value = savedVersion;
                } else {
                    selector.value = bibleVersions[0].number; // Default to the first version
                }
            }
            //================================================
            // END OF LIBRARY
            //================================================

            //-------------------*/
            //  Reset Progress Logic
            //-------------------*/
            const resetProgressButton = document.getElementById('reset-progress-button');
        
            function handleResetProgress() {
                // Confirmation dialog to prevent accidental deletion
                const isConfirmed = window.confirm("Are you sure you want to reset all your reading progress? This action cannot be undone.");
        
                if (isConfirmed) {
                    const keysToRemove = [];
                    // Find all keys related to this app
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key.startsWith('dammieOptimusPlan_')) { // The prefix for the NT app
                            keysToRemove.push(key);
                        }
                    }
        
                    // Remove all found keys
                    keysToRemove.forEach(key => {
                        localStorage.removeItem(key);
                    });
        
                    // Reload the page to reflect the changes
                    location.reload();
                }
            }
            resetProgressButton.addEventListener('click', handleResetProgress);

            //-------------------*/
            //  1. Data for Reading Plans
            //-------------------*/
            const canonicalReadings = [
                { day: 1, readings: "Matthew 1-9", chapters: 9, notes: "Witness Jesus’s divine birth, His baptism, and the revolutionary Sermon on the Mount that turns the world’s values upside down." },
                { day: 2, readings: "Matthew 10-18", chapters: 9, notes: "Jesus commissions His twelve disciples, teaches in powerful parables, and miraculously feeds five thousand people." },
                { day: 3, readings: "Matthew 19-27", chapters: 9, notes: "The journey to the cross intensifies with the Transfiguration, the Triumphal Entry, and Christ’s ultimate sacrifice." },
                { day: 4, readings: "Matthew 28 & Mark 1-8", chapters: 9, notes: "He is risen! The Great Commission is given. Then, dive into Mark’s fast-paced, action-packed account of Jesus’s ministry." },
                { day: 5, readings: "Mark 9-16", chapters: 8, notes: "Mark’s gospel races toward its conclusion with more miracles, sharp teachings, and a powerful, concise account of the resurrection." },
                { day: 6, readings: "Luke 1-9", chapters: 9, notes: "Luke, the physician, provides a detailed, orderly account of Jesus’s birth, early life, and the beginning of His Galilean ministry." },
                { day: 7, readings: "Luke 10-18", chapters: 9, notes: "Encounter some of the most beloved stories ever told, including the parables of the Good Samaritan and the Prodigal Son." },
                { day: 8, readings: "Luke 19-24 & John 1-2", chapters: 8, notes: "Luke’s narrative climaxes with the crucifixion and resurrection. Then, step into John’s profound theological opening: 'In the beginning was the Word.'" },
                { day: 9, readings: "John 3-11", chapters: 9, notes: "Explore deep conversations with Nicodemus and the woman at the well, and witness the astonishing miracle of Lazarus being raised from the dead." },
                { day: 10, readings: "John 12-21", chapters: 10, notes: "Walk with Jesus through His final week, listen to the intimate Upper Room Discourse, and stand in awe of His post-resurrection appearances." },
                { day: 11, readings: "Acts 1-9", chapters: 9, notes: "The adventure of the early church begins! Witness the ascension, the dramatic arrival of the Holy Spirit at Pentecost, and the radical conversion of Saul." },
                { day: 12, readings: "Acts 10-18", chapters: 9, notes: "The Gospel breaks barriers as Peter preaches to Gentiles, and Paul embarks on his first incredible missionary journeys." },
                { day: 13, readings: "Acts 19-28", chapters: 10, notes: "Paul’s ministry causes a riot in Ephesus, leading to his arrest and a perilous, storm-tossed journey to stand trial in Rome." },
                { day: 14, readings: "Romans 1-9", chapters: 9, notes: "Dive into Paul’s theological masterpiece, a profound explanation of God’s plan for salvation, grace, and freedom from sin." },
                { day: 15, readings: "Romans 10-16 & 1 Corinthians 1", chapters: 8, notes: "Paul outlines the practical beauty of living out the gospel, then begins to address the messy divisions within the Corinthian church." },
                { day: 16, readings: "1 Corinthians 2-10", chapters: 9, notes: "Paul tackles deep issues of spiritual wisdom, church discipline, and how to live with Christian liberty and love." },
                { day: 17, readings: "1 Corinthians 11-16 & 2 Corinthians 1-2", chapters: 8, notes: "Explore teachings on worship, the famous 'love chapter,' the reality of the resurrection, and Paul’s comfort in affliction." },
                { day: 18, readings: "2 Corinthians 3-13", chapters: 11, notes: "In this deeply personal letter, Paul defends his apostolic ministry and speaks of strength found in weakness." },
                { day: 19, readings: "Galatians 1-6 & Ephesians 1-3", chapters: 9, notes: "Read Paul’s passionate defense of the gospel of grace in Galatians, then marvel at the spiritual riches believers possess in Christ in Ephesians." },
                { day: 20, readings: "Ephesians 4-6 & Philippians 1-4 & Colossians 1-2", chapters: 9, notes: "Learn about church unity, put on the Armor of God, find the secret to joy in suffering, and celebrate the absolute supremacy of Christ." },
                { day: 21, readings: "Colossians 3-4 & 1 Thessalonians 1-5 & 2 Thessalonians 1-3", chapters: 10, notes: "Set your heart on things above. Then read Paul’s earliest letters, filled with encouragement and instruction about Christ's return." },
                { day: 22, readings: "1 Timothy 1-6 & 2 Timothy 1-4", chapters: 10, notes: "Paul gives vital instructions on church leadership and sound doctrine, ending with his poignant, final charge to his protégé Timothy." },
                { day: 23, readings: "Titus 1-3 & Philemon 1 & Hebrews 1-5", chapters: 9, notes: "Instructions for church order in Crete, a beautiful appeal for a runaway slave, and a powerful argument for the superiority of Christ over all." },
                { day: 24, readings: "Hebrews 6-13", chapters: 8, notes: "A masterful explanation of Jesus as our Great High Priest, followed by the inspiring 'Hall of Faith' in chapter 11." },
                { day: 25, readings: "James 1-5 & 1 Peter 1-4", chapters: 9, notes: "James challenges us to be 'doers of the word,' while Peter offers profound encouragement for finding hope in the midst of suffering." },
                { day: 26, readings: "1 Peter 5 & 2 Peter 1-3 & 1 John 1-4", chapters: 9, notes: "Instructions for church elders, stern warnings against false teachers, and John’s beautiful reminders that God is light and love." },
                { day: 27, readings: "1 John 5 & 2 John 1 & 3 John 1 & Jude 1 & Revelation 1-4", chapters: 8, notes: "Find assurance of salvation, walk in truth and love, contend for the faith, and read Jesus’s personal letters to the seven churches." },
                { day: 28, readings: "Revelation 5-13", chapters: 9, notes: "John’s stunning vision of the throne room of heaven unfolds into a cosmic drama of seals, trumpets, and spiritual warfare." },
                { day: 29, readings: "Revelation 14-22", chapters: 9, notes: "The vision climaxes with the fall of Babylon, the marriage supper of the Lamb, and the glorious arrival of the new heaven and new earth." },
                { day: 30, readings: "Catch-Up / Reflection Day", chapters: '-', notes: "Reflect on the incredible story of Jesus and the birth of His church. How has His story impacted yours?" }
            ];
            
            const chronologicalReadings = [
                { day: 1, readings: "Luke 1-9", chapters: 9, notes: "Begin with Luke's detailed, historical account of Jesus's miraculous birth and the start of His powerful ministry." },
                { day: 2, readings: "Luke 10-18", chapters: 9, notes: "Journey with Jesus as He teaches unforgettable parables like the Good Samaritan and the Prodigal Son." },
                { day: 3, readings: "Luke 19-24 & John 1-2", chapters: 8, notes: "Witness the Triumphal Entry, crucifixion, and resurrection, then see it all again through John's cosmic lens: 'The Word became flesh.'" },
                { day: 4, readings: "John 3-11", chapters: 9, notes: "Explore some of the deepest theological conversations in Scripture and witness the climactic raising of Lazarus from the dead." },
                { day: 5, readings: "John 12-21", chapters: 10, notes: "Experience Jesus' final week, hear his intimate farewell to His disciples, and rejoice in His resurrection appearances." },
                { day: 6, readings: "Mark 1-9", chapters: 9, notes: "Read Mark’s fast-paced, action-oriented gospel, which powerfully presents Jesus as the suffering servant and conquering king." },
                { day: 7, readings: "Mark 10-16 & Matthew 1-2", chapters: 9, notes: "Follow Jesus' final journey to Jerusalem in Mark, then turn to Matthew for the rich story of Jesus's genealogy and birth." },
                { day: 8, readings: "Matthew 3-11", chapters: 9, notes: "Hear Jesus's authoritative teaching in the Sermon on the Mount and see His power as He calls His first disciples." },
                { day: 9, readings: "Matthew 12-20", chapters: 9, notes: "Dive into the parables of the kingdom, witness Peter's great confession, and see Jesus's glory revealed at the Transfiguration." },
                { day: 10, readings: "Matthew 21-28", chapters: 8, notes: "Matthew's gospel concludes with Jesus's final conflicts in Jerusalem, His sacrificial death, and His glorious resurrection command: the Great Commission." },
                { day: 11, readings: "Acts 1-9", chapters: 9, notes: "The story explodes into action with the birth of the Church at Pentecost, the first miracles, and the dramatic conversion of Saul." },
                { day: 12, readings: "Acts 10-14 & James 1-5", chapters: 10, notes: "See the Gospel cross cultural boundaries to the Gentiles, then read James's intensely practical letter on how true faith works." },
                { day: 13, readings: "Galatians 1-6 & Acts 15-16", chapters: 8, notes: "Read Paul’s passionate letter defending freedom in Christ, then see how the early church leaders confirmed this truth at the Jerusalem Council." },
                { day: 14, readings: "1 Thessalonians 1-5 & 2 Thessalonians 1-3", chapters: 8, notes: "Discover Paul's earliest letters, written to a young church, full of affection and urgent instruction about the return of Christ." },
                { day: 15, readings: "Acts 17-19 & 1 Corinthians 1-4", chapters: 10, notes: "Travel with Paul to Athens and Ephesus, then read his first letter to Corinth, addressing the problem of division head-on." },
                { day: 16, readings: "1 Corinthians 5-13", chapters: 9, notes: "Paul confronts serious moral and ethical issues in the church, providing godly wisdom on everything from lawsuits to spiritual gifts." },
                { day: 17, readings: "1 Corinthians 14-16 & 2 Corinthians 1-5", chapters: 8, notes: "Discover the importance of the resurrection, and then turn to Paul’s most personal letter, a deep and emotional defense of his ministry." },
                { day: 18, readings: "2 Corinthians 6-13", chapters: 8, notes: "Paul continues his heartfelt appeal, describing the trials of ministry and the secret of finding God's strength in human weakness." },
                { day: 19, readings: "Romans 1-9", chapters: 9, notes: "Engage with Paul’s theological masterpiece, a brilliant and systematic explanation of God's righteousness revealed through faith in Jesus." },
                { day: 20, readings: "Romans 10-16 & Acts 20-23", chapters: 10, notes: "Learn how the gospel transforms our lives and relationships, then follow Paul's emotional farewell and his dramatic arrest in Jerusalem." },
                { day: 21, readings: "Acts 24-28", chapters: 5, notes: "A lighter day. Follow Paul the prisoner as he stands trial before governors and kings, culminating in a shipwreck on his way to Rome." },
                { day: 22, readings: "Colossians 1-4 & Philemon 1 & Ephesians 1-3", chapters: 8, notes: "From prison, Paul writes of the supreme majesty of Christ, makes a personal appeal for a slave, and celebrates the believer's spiritual riches." },
                { day: 23, readings: "Ephesians 4-6 & Philippians 1-4", chapters: 7, notes: "Another lighter day. Read instructions on church unity, the Armor of God, and Paul’s famous letter of joy, written from a jail cell." },
                { day: 24, readings: "1 Timothy 1-6 & Titus 1-3", chapters: 9, notes: "Paul's 'Pastoral Epistles' give timeless, practical instructions for establishing healthy leadership and sound doctrine in the church." },
                { day: 25, readings: "1 Peter 1-5 & Hebrews 1-4", chapters: 9, notes: "Peter writes to encourage suffering Christians with a 'living hope,' while Hebrews begins its masterful argument for the absolute superiority of Christ." },
                { day: 26, readings: "Hebrews 5-13", chapters: 9, notes: "Go deeper into the role of Jesus as our Great High Priest and be inspired by the heroes of faith in the famous 'Hall of Faith.'" },
                { day: 27, readings: "2 Timothy 1-4 & 2 Peter 1-3", chapters: 7, notes: "Read Paul's final, poignant words written shortly before his death, and Peter’s urgent, final warning against false teachers." },
                { day: 28, readings: "Jude 1 & 1 John 1-5 & 2 John 1 & 3 John 1", chapters: 9, notes: "A fierce letter from Jude encourages believers to 'contend for the faith,' followed by John’s beautiful letters on living in God's love and light." },
                { day: 29, readings: "Revelation 1-11", chapters: 11, notes: "John's spectacular vision begins, with letters to the churches and the unfolding cosmic drama of the seals and trumpets." },
                { day: 30, readings: "Revelation 12-22", chapters: 11, notes: "The vision builds to a stunning climax: the final battle, the fall of evil, and the glorious arrival of the new Jerusalem. He is making all things new!" }
            ];

            //-------------------*/
            //  2. Element References
            //-------------------*/
            const canonicalContainer = document.getElementById('canonical-plan');
            const chronologicalContainer = document.getElementById('chronological-plan');
            const planButtons = document.querySelectorAll('.plan-button');

            //-------------------*/
            //  3. Functions
            //-------------------*/

            /**
             * Generates the HTML for a single day card.
             * @param {object} dayData - The data for the day.
             * @param {string} planName - The name of the plan ('canonical' or 'chronological').
             * @returns {string} - The HTML string for the day card.
             */
            function createDayCardHTML(dayData, planName) {
                const notesHTML = dayData.notes ? `<p class="notes">${dayData.notes}</p>` : '';
                const fullPlanName = `${planName === 'canonical' ? 'Canonical' : 'Chronological'} NT 1-Month Reading`;
                
                return `
                    <div class="day-card" id="${planName}-day-${dayData.day}">
                        <div class="card-header">
                            <h3>Day ${dayData.day}</h3>
                            <div class="card-actions">
                                <button class="copy-button" title="Copy Reading" data-day="${dayData.day}" data-readings="${dayData.readings}" data-plan-name="${fullPlanName}" data-notes="${dayData.notes || ''}">
                                    <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                                    <svg class="check-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                </button>
                                <input type="checkbox" id="check-${planName}-${dayData.day}" class="completion-checkbox" data-plan="${planName}" data-day="${dayData.day}">
                                <label for="check-${planName}-${dayData.day}" class="completion-label"></label>
                            </div>
                        </div>
                        <div class="card-content">
                            <p class="scripture">${dayData.readings}</p>
                            <div class="scripture-buttons">
                                ${parseReadingsAndCreateButtons(dayData.readings)}
                            </div>
                            <p class="chapters">Chapters: ${dayData.chapters}</p>
                            ${notesHTML}
                        </div>
                    </div>
                `;
            }

            /**
             * Populates a container with day cards for a given plan.
             * @param {HTMLElement} container - The container element.
             * @param {Array<object>} planData - The array of reading data.
             * @param {string} planName - The name of the plan.
             */
            function populatePlan(container, planData, planName) {
                container.innerHTML = planData.map(day => createDayCardHTML(day, planName)).join('');
            }

            /**
             * Handles switching between plans.
             * @param {Event} e - The click event.
             */
            function switchPlan(e) {
                const selectedPlan = e.target.dataset.plan;

                planButtons.forEach(button => button.classList.remove('active'));
                e.target.classList.add('active');

                if (selectedPlan === 'canonical') {
                    canonicalContainer.style.display = 'grid';
                    chronologicalContainer.style.display = 'none';
                } else {
                    canonicalContainer.style.display = 'none';
                    chronologicalContainer.style.display = 'grid';
                }
            }

            /**
             * Saves the completion state of a day to localStorage. [11]
             * @param {string} plan - The name of the plan.
             * @param {number} day - The day number.
             * @param {boolean} isCompleted - The completion status.
             */
            function saveProgress(plan, day, isCompleted) {
                const key = `dammieOptimusPlan_${plan}_day_${day}`;
                localStorage.setItem(key, isCompleted);[1, 13]
            }

            /**
             * Loads progress from localStorage and updates the UI. [10]
             */
            function loadProgress() {
                const checkboxes = document.querySelectorAll('.completion-checkbox');
                checkboxes.forEach(checkbox => {
                    const { plan, day } = checkbox.dataset;
                    const key = `dammieOptimusPlan_${plan}_day_${day}`;
                    const isCompleted = localStorage.getItem(key) === 'true';

                    if (isCompleted) {
                        checkbox.checked = true;
                        document.getElementById(`${plan}-day-${day}`).classList.add('completed');
                    }
                });
            }

            /**
             * Handles checkbox changes to update UI and save progress.
             * @param {Event} e - The change event.
             */
            function handleCheckboxChange(e) {
                const checkbox = e.target;
                if (!checkbox.classList.contains('completion-checkbox')) return;

                const { plan, day } = checkbox.dataset;
                const card = document.getElementById(`${plan}-day-${day}`);

                if (checkbox.checked) {
                    card.classList.add('completed');
                    saveProgress(plan, day, true);
                } else {
                    card.classList.remove('completed');
                    saveProgress(plan, day, false);
                }
            }


            //-------------------*/
            //  4. Initial Setup & Event Listeners
            //-------------------*/

            /**
             * Handles the copy button click to copy the reading and note to the clipboard.
             * @param {Event} e - The click event.
             */
            function handleCopyClick(e) {
                const copyButton = e.target.closest('.copy-button');
                if (!copyButton) return;
            
                // Destructure the data, now including 'notes'
                const { day, readings, planName, notes } = copyButton.dataset;
                
                // Start with the base text
                let copyText = `Day ${day} (${planName}) - ${readings}`;
            
                // If a note exists and isn't empty, add it on a new line
                if (notes && notes.trim() !== '') {
                    copyText += `\n\nNote: ${notes}`;
                }
            
                navigator.clipboard.writeText(copyText).then(() => {
                    copyButton.classList.add('copied');
                    setTimeout(() => {
                        copyButton.classList.remove('copied');
                    }, 2000); // Revert back after 2 seconds
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            }
            
            // Add event listeners
            document.body.addEventListener('click', handleCopyClick);

            // Initialize Version Selector
            populateVersionSelector();
            loadVersionPreference();
            document.getElementById('version-selector').addEventListener('change', handleVersionChange);

            // Populate both plan containers
            populatePlan(canonicalContainer, canonicalReadings, 'canonical');
            populatePlan(chronologicalContainer, chronologicalReadings, 'chronological');

            // Load any saved progress from previous sessions
            loadProgress();

            // Add event listeners
            planButtons.forEach(button => button.addEventListener('click', switchPlan));
            document.body.addEventListener('change', handleCheckboxChange);

            setTimeout(scrollToLastViewedPosition, 100);
        });
    </script>

</body>

</html>
